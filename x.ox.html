<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Tic Tac Toe</title>
  </head>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 50px;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 5px;
    }

    .cell {
      width: 100px;
      height: 100px;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5em;
      cursor: pointer;
    }

    .cell.X {
      color: red;
    }

    .cell.O {
      color: blue;
    }

    #message {
      margin: 20px;
      font-size: 1.5em;
    }

    button {
      padding: 10px 20px;
      font-size: 1em;
    }
  </style>
  <body>
    <div id="board" class="board">
      <!-- 9 cells -->
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
      <div class="cell" data-cell></div>
    </div>
    <div id="message"></div>
    <button id="restartButton">Restart</button>

    <script>
      const cells = document.querySelectorAll("[data-cell]");
      const board = document.getElementById("board");
      const message = document.getElementById("message");
      const restartButton = document.getElementById("restartButton");

      let isXTurn = true;

      const WINNING_COMBINATIONS = [
        [0, 1, 2],
        [3, 4, 5],
        [6, 7, 8], // Rows
        [0, 3, 6],
        [1, 4, 7],
        [2, 5, 8], // Columns
        [0, 4, 8],
        [2, 4, 6], // Diagonals
      ];

      function startGame() {
        cells.forEach((cell) => {
          cell.classList.remove("X", "O");
          cell.textContent = "";
          cell.addEventListener("click", handleClick, { once: true });
        });
        isXTurn = true;
        message.textContent = "X's Turn";
      }

      function handleClick(e) {
        const cell = e.target;
        const currentClass = isXTurn ? "X" : "O";
        placeMark(cell, currentClass);

        if (checkWin(currentClass)) {
          endGame(false, currentClass);
        } else if (isDraw()) {
          endGame(true);
        } else {
          isXTurn = !isXTurn;
          message.textContent = `${isXTurn ? "X" : "O"}'s Turn`;
        }
      }

      function placeMark(cell, currentClass) {
        cell.classList.add(currentClass);
        cell.textContent = currentClass;
      }

      function checkWin(currentClass) {
        return WINNING_COMBINATIONS.some((combination) => {
          return combination.every((index) => {
            return cells[index].classList.contains(currentClass);
          });
        });
      }

      function isDraw() {
        return [...cells].every((cell) => {
          return cell.classList.contains("X") || cell.classList.contains("O");
        });
      }

      function endGame(draw, winner) {
        if (draw) {
          message.textContent = "Draw!";
        } else {
          message.textContent = `${winner} Wins!`;
        }
        cells.forEach((cell) => {
          cell.removeEventListener("click", handleClick);
        });
      }

      restartButton.addEventListener("click", startGame);

      // Start on load
      startGame();
    </script>
  </body>
</html>
